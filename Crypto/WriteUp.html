<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        CodiMD - Collaborative markdown notes
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.summershrimp.com/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.summershrimp.com/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/css/bootstrap.min.css" integrity="sha256-H0KfTigpUV+0/5tn2HXC0CPwhhDhWgSawJdnFd0CGCo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fork-awesome/1.1.3/css/fork-awesome.min.css" integrity="sha256-ZhApazu+kejqTYhMF+1DzNKjIzP7KXu6AzyXcC1gMus=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.night .markdown-body blockquote{color:#bcbcbc}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.night .markdown-body h1,.night .markdown-body h2,.night .markdown-body h3,.night .markdown-body h4,.night .markdown-body h5,.night .markdown-body h6{color:#ddd}.markdown-body h1 .fa-link,.markdown-body h2 .fa-link,.markdown-body h3 .fa-link,.markdown-body h4 .fa-link,.markdown-body h5 .fa-link,.markdown-body h6 .fa-link{color:#000;vertical-align:middle;visibility:hidden;font-size:16px}.night .markdown-body h1 .fa-link,.night .markdown-body h2 .fa-link,.night .markdown-body h3 .fa-link,.night .markdown-body h4 .fa-link,.night .markdown-body h5 .fa-link,.night .markdown-body h6 .fa-link{color:#fff}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .fa-link,.markdown-body h2:hover .anchor .fa-link,.markdown-body h3:hover .anchor .fa-link,.markdown-body h4:hover .anchor .fa-link,.markdown-body h5:hover .anchor .fa-link,.markdown-body h6:hover .anchor .fa-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.night .markdown-body table tr{background-color:#5f5f5f}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.night .markdown-body table tr:nth-child(2n){background-color:#4f4f4f}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.night .markdown-body code,.night .markdown-body tt{color:#eee;background-color:hsla(0,0%,90.2%,.36)}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.night .markdown-body pre{filter:invert(100%)}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-webkit-inline-flex;display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.night .markdown-body .gist table tr:nth-child(2n){background-color:#ddd}.markdown-body code[data-gist-id]{background:none;padding:0;filter:invert(100%)}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.night .markdown-body pre.graphviz .graph>polygon{fill:#333}.night .markdown-body pre.mermaid .sectionTitle,.night .markdown-body pre.mermaid .titleText,.night .markdown-body pre.mermaid text{fill:#fff}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.night .markdown-body .abc path{fill:#eee}.night .markdown-body .abc path.note_selected{fill:##4DD0E1}.night tspan{fill:#fefefe}.night pre rect{fill:transparent}.night pre.flow-chart path,.night pre.flow-chart rect{stroke:#fff}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body img{background-color:transparent}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;-webkit-transition:opacity .2s;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;-webkit-transition:opacity .2s;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.3;background-color:#ccc;border:none}.ui-toc-label,.ui-toc .open .ui-toc-label{-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.night .ui-toc-dropdown .nav>li>a:focus,.night .ui-toc-dropdown .nav>li>a:hover{color:#fff;border-left-color:#fff}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.night .ui-toc-dropdown .nav>.active:focus>a,.night .ui-toc-dropdown .nav>.active:hover>a,.night .ui-toc-dropdown .nav>.active>a{color:#fff;border-left:2px solid #fff}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.night .ui-toc-dropdown .nav>li>a{color:#aaa}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,"\30D2\30E9\30AE\30CE\89D2\30B4   Pro W3",Osaka,Meiryo,"\30E1\30A4\30EA\30AA",MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,"\5FAE\8EDF\6B63\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,"\5FAE\8EDF\6B63\9ED1UI",sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,"\5FAE\8F6F\96C5\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,"\5FAE\8F6F\96C5\9ED1UI",sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}small span{line-height:22px}small .dropdown{display:inline-block}small .dropdown a:focus,small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}.night .navbar{background:#333;border-bottom-color:#333;color:#eee}.night .navbar a{color:#eee}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid"><h2 id="Crypto"><a class="anchor hidden-xs" href="#Crypto" title="Crypto"><i class="fa fa-link"></i></a>Crypto</h2><h3 id="DSA"><a class="anchor hidden-xs" href="#DSA" title="DSA"><i class="fa fa-link"></i></a>DSA</h3><h4 id="出题思路"><a class="anchor hidden-xs" href="#出题思路" title="出题思路"><i class="fa fa-link"></i></a>出题思路</h4><p>该题的漏洞点在于DSA数字签名方案中的随机数k的唯一性，随机数k在DSA数字签名中起到了类似于时间戳的作用。一旦两次签名中的k相同，就会造成私钥泄露。因此本题在给出的若干条消息签名中，故意使用重复的随机数k。</p><h3 id="解题思路"><a class="anchor hidden-xs" href="#解题思路" title="解题思路"><i class="fa fa-link"></i></a>解题思路</h3><h5 id="DSA数字签名"><a class="anchor hidden-xs" href="#DSA数字签名" title="DSA数字签名"><i class="fa fa-link"></i></a>DSA数字签名</h5><h5 id="签名方案"><a class="anchor hidden-xs" href="#签名方案" title="签名方案"><i class="fa fa-link"></i></a>签名方案</h5><ol>
<li>选定公共参数<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>g</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.379em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1002.38em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-4" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-5" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑔</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">p,q,g</script></span>，其中<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>g</mi><mi>q</mi></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>p</mi><mo>=</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8" style="width: 6.769em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.581em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1005.48em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-9"><span class="msubsup" id="MathJax-Span-10"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-11" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.519em;"><span class="mi" id="MathJax-Span-12" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-13" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-14" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-15" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-16" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mi>q</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">g^q \bmod p=1</script></span>，即<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-17" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.52em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-family: STIXGeneral-Italic;">𝑔</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">g</script></span>的阶为<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-20" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.47em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-family: STIXGeneral-Italic;">𝑝</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">p</script></span>；</li>
<li>签名方随机生成私钥<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-23" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.52em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-family: STIXGeneral-Italic;">𝑥</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">x</script></span>，满足<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;lt;</mo><mi>x</mi><mo>&amp;lt;</mo><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 5.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.135em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1004.13em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mn" id="MathJax-Span-28" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-29" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑥</span><span class="mo" id="MathJax-Span-31" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-32" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>&lt;</mo><mi>x</mi><mo>&lt;</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">0<x<q</script></span>，计算并公开公钥<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-33" style="width: 6.821em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.633em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1005.63em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-34"><span class="mi" id="MathJax-Span-35" style="font-family: STIXGeneral-Italic;">𝑦</span><span class="mo" id="MathJax-Span-36" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-37" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-38" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.519em;"><span class="mi" id="MathJax-Span-39" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-40" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-41" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">y=g^x \bmod q</script></span></li>
<li>针对消息<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.67em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral-Italic;">𝑚</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">m</script></span>，起算其哈希值<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo>=</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-45" style="width: 5.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.135em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1004.08em, 2.792em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-family: STIXGeneral-Italic;">ℎ</span><span class="mo" id="MathJax-Span-48" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-49" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-50" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-51" style="font-family: STIXGeneral-Italic;">𝑚</span><span class="mo" id="MathJax-Span-52" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">h=H(m)</script></span>，并生成随机数<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1000.52em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: STIXGeneral-Italic;">𝑘</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">k</script></span>，满足<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;lt;</mo><mi>k</mi><mo>&amp;lt;</mo><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-56" style="width: 5.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.135em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1004.13em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="mn" id="MathJax-Span-58" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-59" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-60" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑘</span><span class="mo" id="MathJax-Span-61" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-62" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">0<k<q</script></span>；</li>
<li>计算<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>g</mi><mi>k</mi></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>p</mi><mo stretchy=&quot;false&quot;>)</mo><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-63" style="width: 10.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.042em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1009.04em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-66" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-67" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="msubsup" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-69" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.519em;"><span class="mi" id="MathJax-Span-70" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-71" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-73" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-74" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-75" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>k</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">r=(g^k \bmod p) \bmod q</script></span>；（相当于时间戳，防止重放攻击）</li>
<li>计算<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo stretchy=&quot;false&quot;>)</mo><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" style="width: 13.536em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.16em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1011.16em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="mi" id="MathJax-Span-78" style="font-family: STIXGeneral-Italic;">𝑠</span><span class="mo" id="MathJax-Span-79" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-80" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.52em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-81" style="font-family: STIXGeneral-Italic;">𝑘</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.519em;"><span class="texatom" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mo" id="MathJax-Span-84" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-85" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-86" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral-Italic;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-88" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-89" style="font-family: STIXGeneral-Italic;">𝑚</span><span class="mo" id="MathJax-Span-90" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-91" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">+</span><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral-Italic; padding-left: 0.261em;">𝑥</span><span class="mi" id="MathJax-Span-93" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-94" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-96" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">s=k^{−1}(H(m)+xr) \bmod q</script></span>；</li>
<li>以<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;lt;</mo><mi>r</mi><mo>,</mo><mi>s</mi><mo>&amp;gt;</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-97" style="width: 4.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em, 1003.26em, 2.792em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-98"><span class="mo" id="MathJax-Span-99" style="font-family: STIXGeneral-Regular;">&lt;</span><span class="mi" id="MathJax-Span-100" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑟</span><span class="mo" id="MathJax-Span-101" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-102" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑠</span><span class="mo" id="MathJax-Span-103" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><mi>r</mi><mo>,</mo><mi>s</mi><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-14"><r,s></script></span>为数字签名。</li>
</ol><h5 id="验签方案"><a class="anchor hidden-xs" href="#验签方案" title="验签方案"><i class="fa fa-link"></i></a>验签方案</h5><p>接收方在已知公共参数<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>g</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.379em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1002.38em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-107" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-108" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-109" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-110" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑔</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">p,q,g</script></span>和接收到消息<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-111" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.67em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-family: STIXGeneral-Italic;">𝑚</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">m</script></span>与签名<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;lt;</mo><mi>r</mi><mo>,</mo><mi>s</mi><mo>&amp;gt;</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-114" style="width: 4.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em, 1003.26em, 2.792em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-115"><span class="mo" id="MathJax-Span-116" style="font-family: STIXGeneral-Regular;">&lt;</span><span class="mi" id="MathJax-Span-117" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑟</span><span class="mo" id="MathJax-Span-118" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑠</span><span class="mo" id="MathJax-Span-120" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><mi>r</mi><mo>,</mo><mi>s</mi><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-17"><r,s></script></span>的基础上，可以通过验证以下等式是否成立来验证签名是否有效。<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>r</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo>+</mo><msup><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mi>r</mi></mrow></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>p</mi><mo stretchy=&quot;false&quot;>)</mo><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-121" style="width: 17.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.31em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1014.31em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-124" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-125" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="msubsup" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 3.153em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.519em;"><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="msubsup" id="MathJax-Span-130"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-131" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.313em;"><span class="texatom" id="MathJax-Span-132"><span class="mrow" id="MathJax-Span-133"><span class="mo" id="MathJax-Span-134" style="font-size: 50%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-135" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-136" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-137" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑚</span><span class="mo" id="MathJax-Span-139" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-140" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">+</span><span class="msubsup" id="MathJax-Span-141" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.52em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-142" style="font-family: STIXGeneral-Italic;">𝑦</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.519em;"><span class="texatom" id="MathJax-Span-143"><span class="mrow" id="MathJax-Span-144"><span class="msubsup" id="MathJax-Span-145"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.26em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.313em;"><span class="texatom" id="MathJax-Span-147"><span class="mrow" id="MathJax-Span-148"><span class="mo" id="MathJax-Span-149" style="font-size: 50%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-150" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑟</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-152" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-153" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-154" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-155" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-156" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>r</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mi>r</mi></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">
r=(g^{s^{-1}H(m)}+y^{s^{-1}r} \bmod p) \bmod q
</script></span><br>
其中<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-157" style="width: 1.655em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.191em, 1001.35em, 2.327em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-158"><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 1.346em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.467em;"><span class="texatom" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mo" id="MathJax-Span-163" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-164" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">s^{-1}</script></span>指<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.42em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: STIXGeneral-Italic;">𝑠</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">s</script></span>在模<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-168" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.47em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-169"><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">q</script></span>时的乘法逆元。</p><h5 id="利用方法"><a class="anchor hidden-xs" href="#利用方法" title="利用方法"><i class="fa fa-link"></i></a>利用方法</h5><p>一旦发现两条消息<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-171" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1002.74em, 2.792em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-172"><span class="msubsup" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-174" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.726em;"><span class="mn" id="MathJax-Span-175" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-176" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-177" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-178" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.726em;"><span class="mn" id="MathJax-Span-179" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><msub><mi>m</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">m_1,m_2</script></span>的数字签名<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;lt;</mo><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>1</mn></msub><mo>&amp;gt;</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-180" style="width: 5.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.135em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em, 1004.08em, 2.792em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-181"><span class="mo" id="MathJax-Span-182" style="font-family: STIXGeneral-Regular;">&lt;</span><span class="msubsup" id="MathJax-Span-183" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-184" style="font-family: STIXGeneral-Italic;">𝑟</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.416em;"><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-186" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-187" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-188" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-189" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-190" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>1</mn></msub><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-23"><r_1, s_1></script></span>和<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;lt;</mo><msub><mi>r</mi><mn>2</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>&amp;gt;</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" style="width: 5.013em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.135em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em, 1004.08em, 2.792em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-192"><span class="mo" id="MathJax-Span-193" style="font-family: STIXGeneral-Regular;">&lt;</span><span class="msubsup" id="MathJax-Span-194" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-family: STIXGeneral-Italic;">𝑟</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.416em;"><span class="mn" id="MathJax-Span-196" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-197" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-198" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-199" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-200" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-201" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><msub><mi>r</mi><mn>2</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-24"><r_2,s_2></script></span>有<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mi>r</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-202" style="width: 5.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.651em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1004.65em, 2.792em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-203"><span class="msubsup" id="MathJax-Span-204"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-205" style="font-family: STIXGeneral-Italic;">𝑟</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.416em;"><span class="mn" id="MathJax-Span-206" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-207" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-208" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-209" style="font-family: STIXGeneral-Italic;">𝑟</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.416em;"><span class="mn" id="MathJax-Span-210" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-211" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-212" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑟</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">r_1=r_2=r</script></span>，则说明它们在签名过程中使用了相同的随机数<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-213" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1000.52em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-family: STIXGeneral-Italic;">𝑘</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">k</script></span>。根据签名方案有：<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>k</mi><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi><mspace linebreak=&quot;newline&quot; /><mi>k</mi><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-216" style="width: 100%; display: inline-block; min-width: 12.709em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(3.153em, 1010.49em, 5.684em, -999.997em); top: -3.975em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-217"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1010.49em, 4.341em, -999.997em); top: -3.975em; left: 50%; margin-left: -5.214em;"><span class="mi" id="MathJax-Span-218" style="font-family: STIXGeneral-Italic;">𝑘</span><span class="msubsup" id="MathJax-Span-219"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-220" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-221" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-222" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-223" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-224" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-225"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-226" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.726em;"><span class="mn" id="MathJax-Span-227" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-228" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-229" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">+</span><span class="mi" id="MathJax-Span-230" style="font-family: STIXGeneral-Italic; padding-left: 0.261em;">𝑥</span><span class="mi" id="MathJax-Span-231" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-232" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-233" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1010.49em, 4.341em, -999.997em); top: -2.632em; left: 50%; margin-left: -5.214em;"><span class="mspace" id="MathJax-Span-234" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-235" style="font-family: STIXGeneral-Italic;">𝑘</span><span class="msubsup" id="MathJax-Span-236"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-237" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-238" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-239" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-240" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-241" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-242"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.726em;"><span class="mn" id="MathJax-Span-244" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-245" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-246" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">+</span><span class="mi" id="MathJax-Span-247" style="font-family: STIXGeneral-Italic; padding-left: 0.261em;">𝑥</span><span class="mi" id="MathJax-Span-248" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-249" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-250" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.934em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>k</mi><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi><mspace linebreak="newline"></mspace><mi>k</mi><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">
ks_1=H(m_1)+xr \bmod q\\
ks_2=H(m_2)+xr \bmod q
</script></span><br>
因此有<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>2</mn></msub><mo>&amp;#x2212;</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2261;</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msub><mi>s</mi><mn>1</mn></msub><mo>&amp;#x2212;</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msub><mi>s</mi><mn>2</mn></msub><mspace width=&quot;1em&quot; /><mo stretchy=&quot;false&quot;>(</mo><mi>mod</mi><mspace width=&quot;0.333em&quot; /><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-251" style="width: 22.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.908em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1018.86em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-252"><span class="mi" id="MathJax-Span-253" style="font-family: STIXGeneral-Italic;">𝑥</span><span class="mi" id="MathJax-Span-254" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-255" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-256"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-259" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">−</span><span class="msubsup" id="MathJax-Span-260" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-261" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-262" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-263" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-264" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≡</span><span class="mi" id="MathJax-Span-265" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-266" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-268" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.726em;"><span class="mn" id="MathJax-Span-269" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-270" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-271"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-272" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-273" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-274" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">−</span><span class="mi" id="MathJax-Span-275" style="font-family: STIXGeneral-Italic; padding-left: 0.261em;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-276" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-277"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-278" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.726em;"><span class="mn" id="MathJax-Span-279" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-280" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-281"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-282" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-283" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-284"><span class="mspace" id="MathJax-Span-285" style="height: 0em; vertical-align: 0em; width: 1.139em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-286" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-287" style="font-family: STIXGeneral-Regular;">mod</span><span class="mspace" id="MathJax-Span-288" style="height: 0em; vertical-align: 0em; width: 0.364em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-289" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-290" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo>−</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>≡</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi>s</mi><mn>1</mn></msub><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>s</mi><mn>2</mn></msub><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>q</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">
xr(s_2-s_1)\equiv H(m_2)s_1-H(m_1)s_2 \pmod q
</script></span><br>
所以<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>2</mn></msub><mo>&amp;#x2212;</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msub><mi>s</mi><mn>1</mn></msub><mo>&amp;#x2212;</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-291" style="width: 23.505em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.424em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.449em, 1019.42em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-family: STIXGeneral-Italic;">𝑥</span><span class="mo" id="MathJax-Span-294" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-295" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="mi" id="MathJax-Span-296" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-298"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-299" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-300" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">−</span><span class="msubsup" id="MathJax-Span-302" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-303" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-304" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-306"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-307" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.313em;"><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mo" id="MathJax-Span-310" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-311" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-312" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-313" style="font-family: STIXGeneral-Italic;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-314" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.726em;"><span class="mn" id="MathJax-Span-317" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-318" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-320" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-321" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-322" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">−</span><span class="mi" id="MathJax-Span-323" style="font-family: STIXGeneral-Italic; padding-left: 0.261em;">𝐻<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-324" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-325"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-326" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.726em;"><span class="mn" id="MathJax-Span-327" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-329"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-330" style="font-family: STIXGeneral-Italic;">𝑠</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-331" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-332" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-333" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-334" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo>−</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi>s</mi><mn>1</mn></msub><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">
x=(r(s_2-s_1))^{-1}(H(m_2)s_1-H(m_1)s_2) \bmod q
</script></span><br>
求得私钥<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-335" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.52em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-family: STIXGeneral-Italic;">𝑥</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">x</script></span>后，自然可以根据DSA数字签名方案对任意消息进行签名。</p><h5 id="exp"><a class="anchor hidden-xs" href="#exp" title="exp"><i class="fa fa-link"></i></a>exp</h5><p>略。</p><h3 id="Prime"><a class="anchor hidden-xs" href="#Prime" title="Prime"><i class="fa fa-link"></i></a>Prime</h3><h4 id="出题思路1"><a class="anchor hidden-xs" href="#出题思路1" title="出题思路1"><i class="fa fa-link"></i></a>出题思路</h4><p>对任意两个不同素数<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo>,</mo><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-338" style="width: 1.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1001.4em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-339"><span class="mi" id="MathJax-Span-340" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-341" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-342" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>,</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">p,q</script></span>和整数<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>=</mo><mi>p</mi><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-343" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1002.74em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-family: STIXGeneral-Italic;">𝑛</span><span class="mo" id="MathJax-Span-346" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-347" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑝</span><span class="mi" id="MathJax-Span-348" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mi>p</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">n=pq</script></span>，对任意整数<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mo>,</mo><mn>0</mn><mo>&amp;lt;</mo><mi>m</mi><mo>&amp;lt;</mo><mi>p</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-349" style="width: 6.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.478em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1005.48em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-350"><span class="mi" id="MathJax-Span-351" style="font-family: STIXGeneral-Italic;">𝑚</span><span class="mo" id="MathJax-Span-352" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-353" style="font-family: STIXGeneral-Regular; padding-left: 0.209em;">0</span><span class="mo" id="MathJax-Span-354" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-355" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑚</span><span class="mo" id="MathJax-Span-356" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-357" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑝</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>,</mo><mn>0</mn><mo>&lt;</mo><mi>m</mi><mo>&lt;</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">m,0<m<p</script></span>且<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mo>&amp;lt;</mo><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-358" style="width: 2.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.482em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em, 1002.48em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-family: STIXGeneral-Italic;">𝑚</span><span class="mo" id="MathJax-Span-361" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-362" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>&lt;</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">m<q</script></span>，若<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>n</mi></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>n</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-363" style="width: 6.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.736em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1005.68em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-family: STIXGeneral-Italic;">𝑐</span><span class="mo" id="MathJax-Span-366" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-367" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-368" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.726em;"><span class="mi" id="MathJax-Span-369" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-370" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-371" style="font-family: STIXGeneral-Italic;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>n</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">c=m^n \bmod n</script></span>，则<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>q</mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi><mo>=</mo><mi>m</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-372" style="width: 7.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.943em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.397em, 1005.89em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-373"><span class="msubsup" id="MathJax-Span-374"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-375" style="font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.416em;"><span class="texatom" id="MathJax-Span-376"><span class="mrow" id="MathJax-Span-377"><span class="msup" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-379" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.364em;"><span class="mo" id="MathJax-Span-380" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-381" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-382" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-383" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-384" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑚</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>q</mi><mo>′</mo></msup></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi><mo>=</mo><mi>m</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">
c^{q'} \bmod q= m
</script></span><br>
其中<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>q</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-385" style="width: 1.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1000.83em, 2.534em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-386"><span class="msup" id="MathJax-Span-387"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-388" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.519em;"><span class="mo" id="MathJax-Span-389" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>q</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-37">q'</script></span>满足<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>q</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x22C5;</mo><mi>p</mi><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-390" style="width: 11.056em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.145em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1009.04em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-391"><span class="msup" id="MathJax-Span-392"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-393" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.519em;"><span class="mo" id="MathJax-Span-394" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-395" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">⋅</span><span class="mi" id="MathJax-Span-396" style="font-family: STIXGeneral-Italic; padding-left: 0.261em;">𝑝</span><span class="mo" id="MathJax-Span-397" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mo" id="MathJax-Span-398" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-399" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-400" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">−</span><span class="mn" id="MathJax-Span-401" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">1</span><span class="mo" id="MathJax-Span-402" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-403" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-404" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>q</mi><mo>′</mo></msup><mo>⋅</mo><mi>p</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-38">q' \cdot p \bmod (q-1) = 1</script></span>。</p><p><strong>证明</strong>：<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>q</mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><msup><mi>q</mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mi>p</mi><msup><mi>q</mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>k</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn></mrow></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-405" style="width: 44.011em; display: inline-block;"><span style="display: inline-block; position: relative; width: 36.366em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.397em, 1036.37em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-406"><span class="msubsup" id="MathJax-Span-407"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-408" style="font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.416em;"><span class="texatom" id="MathJax-Span-409"><span class="mrow" id="MathJax-Span-410"><span class="msup" id="MathJax-Span-411"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-412" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.364em;"><span class="mo" id="MathJax-Span-413" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-414" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-415" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-416" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-417" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.726em;"><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span class="msup" id="MathJax-Span-422"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-423" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.364em;"><span class="mo" id="MathJax-Span-424" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-425" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-426" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-427" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-428" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-429" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.726em;"><span class="texatom" id="MathJax-Span-430"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="msup" id="MathJax-Span-434"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-435" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.364em;"><span class="mo" id="MathJax-Span-436" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-437" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-438" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-439" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-440" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 7.079em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-441" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.726em;"><span class="texatom" id="MathJax-Span-442"><span class="mrow" id="MathJax-Span-443"><span class="mo" id="MathJax-Span-444" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-445" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-447" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-448" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-449" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-450" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-451" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-452" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-453" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-454" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span class="mo" id="MathJax-Span-455" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-457" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-458" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-459" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-460" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-461" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-462" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-463" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-464" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-465" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-466" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-467" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.726em;"><span class="texatom" id="MathJax-Span-468"><span class="mrow" id="MathJax-Span-469"><span class="msup" id="MathJax-Span-470"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-471" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.364em;"><span class="mo" id="MathJax-Span-472" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-473" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-475" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-476" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-477" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-478" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-479" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-480"><span class="mspace" id="MathJax-Span-481" style="height: 0em; vertical-align: 0em; width: 0.777em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-482" style="font-family: STIXGeneral-Regular; padding-left: 0.209em;">mod</span><span class="mspace" id="MathJax-Span-483" style="height: 0em; vertical-align: 0em; width: 0.209em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-484" style="height: 0em; vertical-align: 0em; width: 0.209em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-485" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>q</mi><mo>′</mo></msup></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><msup><mi>q</mi><mo>′</mo></msup></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>q</mi><mi>p</mi><msup><mi>q</mi><mo>′</mo></msup></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi><mo>=</mo><msup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>k</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></msup><mspace width="0.667em"></mspace><mi>mod</mi><mspace width="thinmathspace"></mspace><mspace width="thinmathspace"></mspace><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">c^{q'} \bmod q=m^{nq'} \bmod q=m^{qpq'} \bmod q=m^{((q-1)+1)(k(q-1)+1)} \bmod q=m^{k'(q-1)+1} \mod q</script></span></p><p>根据费马小定理：<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>q</mi><mo>=</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-486" style="width: 8.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.614em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.501em, 1006.51em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-487"><span class="msubsup" id="MathJax-Span-488"><span style="display: inline-block; position: relative; width: 1.965em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-489" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.726em;"><span class="texatom" id="MathJax-Span-490"><span class="mrow" id="MathJax-Span-491"><span class="mi" id="MathJax-Span-492" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-493" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-494" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-495" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-496" style="font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-497" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-498" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>q</mi><mo>−</mo><mn>1</mn></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>q</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-40">m^{q-1} \bmod q=1</script></span>，所以<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>k</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn></mrow></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>q</mi><mo>=</mo><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-499" style="width: 11.779em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.713em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.397em, 1009.66em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-500"><span class="msubsup" id="MathJax-Span-501"><span style="display: inline-block; position: relative; width: 3.877em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.726em;"><span class="texatom" id="MathJax-Span-503"><span class="mrow" id="MathJax-Span-504"><span class="msup" id="MathJax-Span-505"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.36em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-506" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.364em;"><span class="mo" id="MathJax-Span-507" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-508" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-509" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-510" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-511" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-512" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-513" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-514" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-515"><span class="mspace" id="MathJax-Span-516" style="height: 0em; vertical-align: 0em; width: 0.777em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-517" style="font-family: STIXGeneral-Regular; padding-left: 0.209em;">mod</span><span class="mspace" id="MathJax-Span-518" style="height: 0em; vertical-align: 0em; width: 0.209em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-519" style="height: 0em; vertical-align: 0em; width: 0.209em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-520" style="font-family: STIXGeneral-Italic; padding-left: 0.209em;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-521" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-522" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑚</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>k</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></msup><mspace width="0.667em"></mspace><mi>mod</mi><mspace width="thinmathspace"></mspace><mspace width="thinmathspace"></mspace><mi>q</mi><mo>=</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">m^{k'(q-1)+1} \mod q=m</script></span>。</p><p>同理<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>q</mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>p</mi><mo>=</mo><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-523" style="width: 7.286em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.994em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.449em, 1005.94em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-524"><span class="msubsup" id="MathJax-Span-525"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-526" style="font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.416em;"><span class="texatom" id="MathJax-Span-527"><span class="mrow" id="MathJax-Span-528"><span class="msup" id="MathJax-Span-529"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-530" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑞<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.364em;"><span class="mo" id="MathJax-Span-531" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-532" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-533" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-534" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-535" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑚</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>q</mi><mo>′</mo></msup></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>=</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">c^{q'} \bmod p= m</script></span>。</p><p>本题在该结论的基础上做了进一步扩展。</p><ol>
<li>将素数数量由2个扩大到4个；</li>
<li>将<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-536" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.67em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-537"><span class="mi" id="MathJax-Span-538" style="font-family: STIXGeneral-Italic;">𝑚</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">m</script></span>的范围扩大到<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;lt;</mo><mi>m</mi><mo>&amp;lt;</mo><mi>n</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-539" style="width: 5.271em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.341em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1004.29em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-540"><span class="mn" id="MathJax-Span-541" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-542" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-543" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑚</span><span class="mo" id="MathJax-Span-544" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&lt;</span><span class="mi" id="MathJax-Span-545" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>&lt;</mo><mi>m</mi><mo>&lt;</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">0<m<n</script></span></li>
</ol><h4 id="解题思路1"><a class="anchor hidden-xs" href="#解题思路1" title="解题思路1"><i class="fa fa-link"></i></a>解题思路</h4><p>1.对给出的<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>n</mi><mn>0</mn></msub><mo>,</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><msub><mi>n</mi><mn>2</mn></msub><mo>,</mo><msub><mi>n</mi><mn>3</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-546" style="width: 6.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.116em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1005.12em, 2.792em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-547"><span class="msubsup" id="MathJax-Span-548"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-549" style="font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-550" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-551" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-552" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-553" style="font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-554" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-555" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-556" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-557" style="font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-558" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-559" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-560" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-561" style="font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-562" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>0</mn></msub><mo>,</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><msub><mi>n</mi><mn>2</mn></msub><mo>,</mo><msub><mi>n</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-45">n_0,n_1,n_2,n_3</script></span>做最大公因子分析，可分别得出他们的四个素因子；</p><p>2.一般的，对<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>=</mo><msub><mi>p</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><msub><mi>p</mi><mn>3</mn></msub><msub><mi>p</mi><mn>4</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-563" style="width: 6.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.529em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1005.53em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-564"><span class="mi" id="MathJax-Span-565" style="font-family: STIXGeneral-Italic;">𝑛</span><span class="mo" id="MathJax-Span-566" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-567" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-568" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-569" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-570"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-571" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-572" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-573"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-574" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-575" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-576"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-577" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-578" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><msub><mi>p</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><msub><mi>p</mi><mn>3</mn></msub><msub><mi>p</mi><mn>4</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">n=p_1p_2p_3p_4</script></span>和<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>n</mi></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>n</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-579" style="width: 6.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.736em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em, 1005.68em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-580"><span class="mi" id="MathJax-Span-581" style="font-family: STIXGeneral-Italic;">𝑐</span><span class="mo" id="MathJax-Span-582" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-583" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.67em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-584" style="font-family: STIXGeneral-Italic;">𝑚</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.726em;"><span class="mi" id="MathJax-Span-585" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-586" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mi" id="MathJax-Span-587" style="font-family: STIXGeneral-Italic;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>n</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">c=m^n \bmod n</script></span>，有<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>&amp;#x2032;</mo></msup></mrow></msup><mo>&amp;#x2261;</mo><mi>m</mi><mspace width=&quot;1em&quot; /><mo stretchy=&quot;false&quot;>(</mo><mi>mod</mi><mspace width=&quot;0.333em&quot; /><msub><mi>p</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-588" style="width: 9.972em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.215em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.397em, 1008.16em, 2.843em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-589"><span class="msubsup" id="MathJax-Span-590"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.42em, 4.135em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-591" style="font-family: STIXGeneral-Italic;">𝑐</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.416em;"><span class="texatom" id="MathJax-Span-592"><span class="mrow" id="MathJax-Span-593"><span class="msup" id="MathJax-Span-594"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.57em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-595"><span class="mrow" id="MathJax-Span-596"><span class="msubsup" id="MathJax-Span-597"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-598" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.364em;"><span class="mi" id="MathJax-Span-599" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.233em; left: 0.571em;"><span class="mo" id="MathJax-Span-600" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-601" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≡</span><span class="mi" id="MathJax-Span-602" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">𝑚</span><span class="TeXmathchoice" id="MathJax-Span-603"><span class="mspace" id="MathJax-Span-604" style="height: 0em; vertical-align: 0em; width: 1.139em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-605" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-606" style="font-family: STIXGeneral-Regular;">mod</span><span class="mspace" id="MathJax-Span-607" style="height: 0em; vertical-align: 0em; width: 0.364em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-608" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-609" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-610" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-611" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>′</mo></msup></mrow></msup><mo>≡</mo><mi>m</mi><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">
c^{{p_i}'}\equiv m \pmod {p_i}
</script></span><br>
其中<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-612" style="width: 1.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.09em, 2.534em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-613"><span class="msup" id="MathJax-Span-614"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.78em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-615"><span class="mrow" id="MathJax-Span-616"><span class="msubsup" id="MathJax-Span-617"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-618" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-619" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.777em;"><span class="mo" id="MathJax-Span-620" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-49">{p_i}'</script></span>满足<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>&amp;#x2032;</mo></msup><mo>&amp;#x22C5;</mo><mfrac><mi>n</mi><msub><mi>p</mi><mi>i</mi></msub></mfrac><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>p</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-621" style="width: 12.244em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.127em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em, 1010.02em, 3.153em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-622"><span class="msup" id="MathJax-Span-623"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.78em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-624"><span class="mrow" id="MathJax-Span-625"><span class="msubsup" id="MathJax-Span-626"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-627" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-628" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.777em;"><span class="mo" id="MathJax-Span-629" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-630" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">⋅</span><span class="mfrac" id="MathJax-Span-631" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -4.388em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-632" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.57em, 4.29em, -999.997em); top: -3.613em; left: 50%; margin-left: -0.256em;"><span class="msubsup" id="MathJax-Span-633"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.364em;"><span class="mi" id="MathJax-Span-635" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.67em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-636" style="font-family: STIXGeneral-Regular; padding-left: 0.313em; padding-right: 0.313em;">mod</span><span class="mo" id="MathJax-Span-637" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-638"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-639" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-640" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-641" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">−</span><span class="mn" id="MathJax-Span-642" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">1</span><span class="mo" id="MathJax-Span-643" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-644" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-645" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>′</mo></msup><mo>⋅</mo><mfrac><mi>n</mi><msub><mi>p</mi><mi>i</mi></msub></mfrac><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mo stretchy="false">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-50">{p_i}' \cdot \frac n {p_i} \bmod (p_i-1) = 1</script></span>，即<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-646" style="width: 1.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.242em, 1001.09em, 2.534em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-647"><span class="msup" id="MathJax-Span-648"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.78em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-649"><span class="mrow" id="MathJax-Span-650"><span class="msubsup" id="MathJax-Span-651"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.47em, 4.341em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-652" style="font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mi" id="MathJax-Span-653" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.777em;"><span class="mo" id="MathJax-Span-654" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>p</mi><mi>i</mi></msub></mrow><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-51">{p_i}'</script></span>是<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mi>n</mi><msub><mi>p</mi><mi>i</mi></msub></mfrac></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-655" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.294em, 1000.88em, 2.843em, -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-656"><span class="mfrac" id="MathJax-Span-657"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.135em, -999.997em); top: -4.388em; left: 50%; margin-left: -0.152em;"><span class="mi" id="MathJax-Span-658" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.515em, 1000.57em, 4.29em, -999.997em); top: -3.613em; left: 50%; margin-left: -0.256em;"><span class="msubsup" id="MathJax-Span-659"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.31em, 4.29em, -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-660" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.364em;"><span class="mi" id="MathJax-Span-661" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em, 1000.67em, 1.242em, -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.674em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>n</mi><msub><mi>p</mi><mi>i</mi></msub></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-52">\frac n {p_i}</script></span>在模$ (p_i-1) $的乘法逆元。</p><p>3.利用中国剩余定理求解<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-662" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.67em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-663"><span class="mi" id="MathJax-Span-664" style="font-family: STIXGeneral-Italic;">𝑚</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">m</script></span>。</p><h4 id="exp1"><a class="anchor hidden-xs" href="#exp1" title="exp1"><i class="fa fa-link"></i></a>exp</h4><pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> gmpy2 <span class="hljs-keyword">as</span> gm
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">crack</span><span class="hljs-params">(N, ns, cs)</span>:</span>
    M = np.ones((N, N))
    M = M.tolist()
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(N):
        M[i][i] = <span class="hljs-number">1</span>
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(N):
            <span class="hljs-keyword">if</span> i != j:
                M[i][j] = gm.gcd(ns[i], ns[j])
                M[i][i] *= M[i][j]
        M[i][i] = ns[i] / M[i][i]

    nsns = [<span class="hljs-number">1</span>] * <span class="hljs-number">4</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(N):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(N):
            nsns[i] *= M[i][j]

    index = np.ones((N, N))
    index = index.tolist()

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(N):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(N):
            index[i][j] = <span class="hljs-number">1</span>
            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(N):
                <span class="hljs-keyword">if</span> k != j:
                    index[i][j] *= gm.invert(M[i][k], M[i][j] - <span class="hljs-number">1</span>)

    cc = np.ones((N, N))
    cc = cc.tolist()
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(N):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(N):
            cc[i][j] = pow(cs[i], index[i][j], M[i][j])

    mms = [<span class="hljs-number">0</span>] * N
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(N):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(N):
            fac = cc[i][j]
            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(N):
                <span class="hljs-keyword">if</span> k != j:
                    fac *= (M[i][k] * gm.invert(M[i][k], M[i][j]))
            mms[i] += fac % ns[i]
        mms[i] = mms[i] % ns[i]
    <span class="hljs-keyword">return</span> mms
</code></pre><h3 id="MT"><a class="anchor hidden-xs" href="#MT" title="MT"><i class="fa fa-link"></i></a>MT</h3><h4 id="出题思路2"><a class="anchor hidden-xs" href="#出题思路2" title="出题思路2"><i class="fa fa-link"></i></a>出题思路</h4><p>随机数发生器MT19937在从状态提取32bits随机数时进行四步平移和异或运算，但该四步运算均为可逆运算，从而导致可从32bits随机数还原状态。</p><pre><code class="python hljs">...
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extract_number</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">if</span> self.index &gt;= <span class="hljs-number">624</span>:
            self.twist()
        y = self.mt[self.index]
        <span class="hljs-comment"># Right shift by 11 bits</span>
        y = y ^ y &gt;&gt; <span class="hljs-number">11</span>
        <span class="hljs-comment"># Shift y left by 7 and take the bitwise and of 2636928640d</span>
        y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span>
        <span class="hljs-comment"># Shift y left by 15 and take the bitwise and of y and 4022730752</span>
        y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span>
        <span class="hljs-comment"># Right shift by 18 bits</span>
        y = y ^ y &gt;&gt; <span class="hljs-number">18</span>
        self.index = self.index + <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> _int32(y)
...
</code></pre><p>本题将这四步运算的参数略作调整，考察选手能否对其进行逆运算。</p><h4 id="解题思路2"><a class="anchor hidden-xs" href="#解题思路2" title="解题思路2"><i class="fa fa-link"></i></a>解题思路</h4><p>分别实现左移和右移异或的逆运算函数，然后调用两个函数对密文解密，得到flag。代码如下。</p><pre><code class="python hljs"><span class="hljs-keyword">from</span> Crypto.Util <span class="hljs-keyword">import</span> number

transformed_flag = <span class="hljs-string">'641460a9e3953b1aaa21f3a2'</span>
c = transformed_flag.decode(<span class="hljs-string">'hex'</span>)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decrypt_left</span><span class="hljs-params">(cipher, blocksize, mask)</span>:</span>
    plain = cipher
    t = cipher
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">32</span> / blocksize):
        tt = (t &lt;&lt; blocksize) &amp; mask
        plain = plain ^ tt
        t = tt
    <span class="hljs-keyword">return</span> plain

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decrypt_right</span><span class="hljs-params">(cipher, blocksize, mask)</span>:</span>
    plain = cipher
    t = cipher
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">32</span> / blocksize):
        tt = (t &gt;&gt; blocksize) &amp; mask
        plain = plain ^ tt
        t = tt
    <span class="hljs-keyword">return</span> plain

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">invert</span><span class="hljs-params">(block)</span>:</span>
    block = decrypt_right(block, <span class="hljs-number">19</span>, <span class="hljs-number">0xffffffff</span>)
    block = decrypt_left(block, <span class="hljs-number">17</span>, <span class="hljs-number">2245263360</span>)
    block = decrypt_left(block, <span class="hljs-number">9</span>, <span class="hljs-number">2029229568</span>)
    block = decrypt_right(block, <span class="hljs-number">13</span>, <span class="hljs-number">0xffffffff</span>)
    <span class="hljs-keyword">return</span> block

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transform</span><span class="hljs-params">(message)</span>:</span>
    <span class="hljs-keyword">assert</span> len(message) % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>
    new_message = <span class="hljs-string">''</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(message) / <span class="hljs-number">4</span>):
        block = message[i * <span class="hljs-number">4</span> : i * <span class="hljs-number">4</span> +<span class="hljs-number">4</span>]
        block = number.bytes_to_long(block)
        block = invert(block)
        block = number.long_to_bytes(block)
        new_message += block
    <span class="hljs-keyword">return</span> new_message

flag = transform(c)
<span class="hljs-keyword">print</span> flag.encode(<span class="hljs-string">'hex'</span>)
</code></pre><h3 id="RSA"><a class="anchor hidden-xs" href="#RSA" title="RSA"><i class="fa fa-link"></i></a>RSA</h3><h4 id="出题思路3"><a class="anchor hidden-xs" href="#出题思路3" title="出题思路3"><i class="fa fa-link"></i></a>出题思路</h4><p>该题考察对RSA的parity oracle或LSB oracle漏洞的利用。网上关于parity oracle漏洞利用的writeup和脚本很多，大多是这样的：</p><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">crack</span><span class="hljs-params">(n, e, c)</span>:</span>
    max = n
    min = <span class="hljs-number">0</span>
    d = pow(<span class="hljs-number">2</span>, e, n)
    cc = c
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
        cc = (cc * d) % n
        parity = getParity(cc) <span class="hljs-comment">#parity oracle返回明文奇偶性</span>
        <span class="hljs-keyword">if</span> parity == <span class="hljs-number">1</span>:
            min = (max + min) / <span class="hljs-number">2</span>
        <span class="hljs-keyword">else</span>:
            max = (max + min) / <span class="hljs-number">2</span>
        <span class="hljs-keyword">if</span> max == min:
            <span class="hljs-keyword">return</span> min
</code></pre><p>原理很简单，但一般情况下最终还原出的明文和真实明文会存在一定偏差，主要原因是max和min是整数类型，其表示的上界和下界不够精确；提高表示精度可以一定程度解决这个问题，但治标不治本，理论上还是存在误差导致还原出的明文不准确。为了增加这种误差存在的概率，原题设置为2048位的<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-665" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.47em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-666"><span class="mi" id="MathJax-Span-667" style="font-family: STIXGeneral-Italic;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">n</script></span>，并且要破解10个<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-668" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em, 1000.67em, 2.637em, -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-669"><span class="mi" id="MathJax-Span-670" style="font-family: STIXGeneral-Italic;">𝑚</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">m</script></span>，后考虑到与服务器交互次数过多，破解时间过长而将参数降低到1024和3。</p><h4 id="解题思路3"><a class="anchor hidden-xs" href="#解题思路3" title="解题思路3"><i class="fa fa-link"></i></a>解题思路</h4><p>这里仅给出精确还原的脚本，其正确性和完备性证明可参见[A Novel Algorithm for Exploiting RSA Plain’s LSB Oracle][1]。</p><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">crack</span><span class="hljs-params">(n, e, c)</span>:</span>
    rounds = int(math.ceil(math.log(n, <span class="hljs-number">2</span>)))
    d = pow(<span class="hljs-number">2</span>, e, n)
    cc = c
    eigenvalue = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(rounds):
        <span class="hljs-keyword">if</span> i % <span class="hljs-number">256</span> == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">print</span> i
        cc = (cc * d) % n
        parity = getParity(cc) <span class="hljs-comment">#parity oracle返回明文奇偶性</span>
        eigenvalue = (eigenvalue &lt;&lt; <span class="hljs-number">1</span>) + parity
    <span class="hljs-keyword">if</span> eigenvalue == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> n * eigenvalue / pow(<span class="hljs-number">2</span>, rounds) + <span class="hljs-number">1</span>
</code></pre></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Crypto" title="Crypto">Crypto</a><ul class="nav">
<li><a href="#DSA" title="DSA">DSA</a><ul class="nav">
<li><a href="#出题思路" title="出题思路">出题思路</a></li>
</ul>
</li>
<li><a href="#解题思路" title="解题思路">解题思路</a></li>
<li><a href="#Prime" title="Prime">Prime</a><ul class="nav">
<li><a href="#出题思路1" title="出题思路">出题思路</a></li>
<li><a href="#解题思路1" title="解题思路">解题思路</a></li>
<li><a href="#exp1" title="exp">exp</a></li>
</ul>
</li>
<li><a href="#MT" title="MT">MT</a><ul class="nav">
<li><a href="#出题思路2" title="出题思路">出题思路</a></li>
<li><a href="#解题思路2" title="解题思路">解题思路</a></li>
</ul>
</li>
<li><a href="#RSA" title="RSA">RSA</a><ul class="nav">
<li><a href="#出题思路3" title="出题思路">出题思路</a></li>
<li><a href="#解题思路3" title="解题思路">解题思路</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Crypto" title="Crypto">Crypto</a><ul class="nav">
<li><a href="#DSA" title="DSA">DSA</a><ul class="nav">
<li><a href="#出题思路" title="出题思路">出题思路</a></li>
</ul>
</li>
<li><a href="#解题思路" title="解题思路">解题思路</a></li>
<li><a href="#Prime" title="Prime">Prime</a><ul class="nav">
<li><a href="#出题思路1" title="出题思路">出题思路</a></li>
<li><a href="#解题思路1" title="解题思路">解题思路</a></li>
<li><a href="#exp1" title="exp">exp</a></li>
</ul>
</li>
<li><a href="#MT" title="MT">MT</a><ul class="nav">
<li><a href="#出题思路2" title="出题思路">出题思路</a></li>
<li><a href="#解题思路2" title="解题思路">解题思路</a></li>
</ul>
</li>
<li><a href="#RSA" title="RSA">RSA</a><ul class="nav">
<li><a href="#出题思路3" title="出题思路">出题思路</a></li>
<li><a href="#解题思路3" title="解题思路">解题思路</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/js/bootstrap.min.js" integrity="sha256-kJrlY+s09+QoWjpkOrXXwhxeaoDz9FW5SaxF8I0DibQ=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
